#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
#include "pixel.h"
using namespace std;
const int WIDTH = 16;
const int HEIGHT = 16;

void readPBMFile(const string& filePath, int image[HEIGHT][WIDTH]) {
    
    ifstream file(filePath);
    string line;

    // Read and verify the magic number
    getline(file, line);
    if (line != "P1") {
        throw runtime_error("File is not in P1 PBM format.");
    }


    // Read dimensions (we already know it's 16x16)
    int width, height;
    stringstream(line) >> width >> height;
    if (width != WIDTH || height != HEIGHT) {
        throw runtime_error("Image dimensions do not match 16x16.");
    }

    // Read pixel data
    for (int y = 0; y < HEIGHT; ++y) {
        for (int x = 0; x < WIDTH; ++x) {
            file >> image[y][x];
        }
    }

    file.close();
}


int main() {
    int image[HEIGHT][WIDTH];
    string filePath = "C:\\Users\\user\\Desktop\\neuro projekt\\example.pbm";

    try {
        readPBMFile(filePath, image);
        
        // Print the image (optional)
        for (int y = 0; y < HEIGHT; ++y) {
            for (int x = 0; x < WIDTH; ++x) {
                cout << (image[y][x] ? '#' : ' ');
            }
            cout << endl;
        }
    } catch (const exception& e) {
        cerr << "Error: " << e.what() << endl;
        return 1;
    }

    return 0;
}
